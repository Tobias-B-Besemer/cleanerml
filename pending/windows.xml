<?xml version="1.0" encoding="UTF-8"?>
<!--

    BleachBit
    Copyright (C) 2008-2019 Andrew Ziem
    https://www.bleachbit.org

    This program is free software: you can redistribute it and/or modify
    it under the terms of the GNU General Public License as published by
    the Free Software Foundation, either version 3 of the License, or
    (at your option) any later version.

    This program is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
    GNU General Public License for more details.

    You should have received a copy of the GNU General Public License
    along with this program. If not, see <http://www.gnu.org/licenses/>.

	Rules in CleanerML written by https://github.com/Tobias-B-Besemer
	v0.6.0 done on 2019-03-07

-->
<cleaner id="windows" os="windows">
  <label>Windows</label>
  <description>Operating System</description>
  <option id="temp">
    <label>Windows Temp Files and Folders</label>
    <description>Delete the Temp Files and Folders in the Windows Directory</description>
        <action command="delete" search="walk.all" path="%WINDIR%\Installer\MSI*.tmp*"/>
        <action command="delete" search="glob" path="%WINDIR%\Installer\MSI*.tmp*"/>
  </option>
  <option id="logs">
    <label>Log Files</label>
    <description>Delete the Log Files in the Windows Directory</description>
        <action command="delete" search="glob" path="%WINDIR%\*.log"/>
        
        <!--
        64-bit Windows redirects %windir%\sysnative\ for 32-bit applications to %windir%\system32 
        https://docs.microsoft.com/en-us/windows/desktop/winprog64/file-system-redirector
        -->
        <action command="delete" search="glob" path="%WINDIR%\sysnative\config\*.log"/>
        <action command="delete" search="glob" path="%WINDIR%\sysnative\config\*.log1"/>
        <action command="delete" search="glob" path="%WINDIR%\sysnative\config\*.log2"/>
        
        <action command="delete" search="glob" path="%SystemDrive%\Boot\*.log"/>
        <action command="delete" search="glob" path="%SystemDrive%\Boot\*.log1"/>
        <action command="delete" search="glob" path="%SystemDrive%\Boot\*.log2"/>
  </option>
  <option id="hibernate">
    <label>Hibernate System</label>
    <description>Turns the Hibernate System of and deletes the Hibernate File</description>
        <action command="process" cmd="powercfg.exe /hibernate off"/>
  </option>
  <option id="junk">
    <label>Junk Files and Folders</label>
    <description>Delete the Junk Files and Folders of Windows</description>
        <action command="delete" search="file" path="%HOMEPATH%\Desktop\desktop.ini"/>
        <action command="delete" search="file" path="%SystemDrive%\BOOTSECT.BAK"/>
        <action command="delete" search="walk.all" path="%SystemDrive%\Config.Msi\"/>
        <action command="delete" search="glob" path="%SystemDrive%\Config.Msi\"/>
  </option>
  <option id="backups">
    <label>Backup Files</label>
    <description>Delete the Backup Files of Windows</description>
        <action command="delete" search="glob" path="%SystemDrive%\Boot\BCD.Backup.*"/>
  </option>
  <option id="chkdsk">
    <label>Chkdsk Files</label>
    <description>Delete the Chkdsk Files</description>
        <action command="delete" search="walk.files" path="%SystemDrive%\File*.chk"/>
        <action command="delete" search="walk.all" path="%SystemDrive%\System Volume Information\Chkdsk\"/>
        <action command="delete" search="glob" path="%SystemDrive%\System Volume Information\Chkdsk\"/>
  </option>
  <option id="wer">
    <label>Windows Error Reporting</label>
    <description>Deletes the Windows Error Reporting Files</description>
        <action command="delete" search="walk.all" path="%ALLUSERSPROFILE%\Microsoft\Windows\WER\ReportArchive\"/>
        <action command="delete" search="walk.all" path="%ALLUSERSPROFILE%\Microsoft\Windows\WER\ReportQueue\"/>
        <action command="delete" search="walk.all" path="%ALLUSERSPROFILE%\Microsoft\Windows\WER\Temp\"/>
        <action command="delete" search="walk.all" path="%LocalAppData%\Microsoft\Windows\WER\ReportArchive\"/>
        <action command="delete" search="walk.all" path="%LocalAppData%\Microsoft\Windows\WER\ReportQueue\"/>
        <action command="delete" search="walk.all" path="%LocalAppData%\Microsoft\Windows\WER\Temp\"/>
        <action command="delete" search="walk.all" path="%LocalAppData%\Microsoft\Windows\WER\ERC\"/>
        <action command="delete" search="walk.all" path="%LocalAppData%\ElevatedDiagnostics\"/>
        <action command="delete" search="walk.all" path="%LocalAppData%\Microsoft\Windows\WER\Temp\"/>
        <action command="winreg" path="HKCU\Software\Microsoft\Windows\Windows Error Reporting\Debug" name="StoreLocation"/>
        <action command="winreg" path="HKLM\Software\Microsoft\Windows\Windows Error Reporting\Debug" name="StoreLocation"/>
        <action command="winreg" path="HKLM\Software\Microsoft\Windows\Windows Error Reporting\LocalDumps"/>
        <action command="winreg" path="HKU\.DEFAULT\Software\Microsoft\Windows\Windows Error Reporting\Debug" name="StoreLocation"/>
  </option>
  <option id="shadow_copies">
    <label>Shadow Copies</label>
    <description>Deletes all Shadow Copies on C:</description>
    <warning>Use the option only if you know what you do!</warning>
    <action command="process" cmd="vssadmin.exe delete shadows /for=c: /all"/>
  </option>
  <option id="recycle_bin">
    <label>Recycle Bin</label>
    <description>Empty Recycle Bin on drive C: from all user accounts</description>
    <warning>Empty Recycle Bin on drive C: from all user accounts! Use the option only if you know what you do!</warning>
    <!-- <action command="process" cmd="cmd.exe /c rd /s c:\$Recycle.Bin"/> -->
    <action command="delete" search="walk.all" path="%SystemDrive%\$Recycle.Bin"/>
    <action command="delete" search="glob" path="%SystemDrive%\$Recycle.Bin"/>
  </option>
  <option id="caches">
    <label>Caches</label>
    <description>Cleaning up some caches</description>
    <action command="delete" search="walk.all" path="%LocalAppData%\Microsoft\Feeds Cache\"/>
    <action command="delete" search="glob" path="%LocalAppData%\Microsoft\Feeds Cache\"/>
    <action command="delete" search="walk.all" path="%LocalAppData%\Microsoft\Terminal Server Client\Cache\"/>
    <action command="delete" search="glob" path="%LocalAppData%\Microsoft\Terminal Server Client\Cache\"/>
    <action command="delete" search="walk.all" path="%LocalAppData%\Microsoft\Windows\AppCache\"/>
    <action command="delete" search="glob" path="%LocalAppData%\Microsoft\Windows\AppCache\"/>
    <action command="delete" search="walk.all" path="%LocalAppData%\Microsoft\Windows\Caches\"/>
    <action command="delete" search="glob" path="%LocalAppData%\Microsoft\Windows\Caches\"/>
    <action command="delete" search="walk.all" path="%LocalAppData%\Microsoft\Windows\SchCache\"/>
    <action command="delete" search="glob" path="%LocalAppData%\Microsoft\Windows\SchCache\"/>
  </option>
</cleaner>
